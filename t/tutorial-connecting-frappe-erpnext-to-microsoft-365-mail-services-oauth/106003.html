<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth - Frappe Framework - Frappe Forum</title>
    <meta name="description" content="Hi: 
To get connection between Frappe mail system and Microsoft365 mail services (formerly known as Office365) you will need: 
Patience / faith :joy: 
1. Requirements. 
Update Frappe to v14.23.0 and above or v13.55.0 and&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.2 - https://github.com/discourse/discourse version 44986e4c0c3acf127ce03216227dd11cc78f4466">
<link rel="icon" type="image/png" href="https://discuss.frappe.io/uploads/default/optimized/3X/a/5/a5e946e67fbe05a61d1c33d08894876d4d9dea7a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="https://discuss.frappe.io/uploads/default/optimized/3X/a/5/a5e946e67fbe05a61d1c33d08894876d4d9dea7a_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003" />

<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.frappe.io/opensearch.xml" title="Frappe Forum Search">

    <link href="/stylesheets/color_definitions_light_8_12_296e8563dbd3c739bd4eafc35307bea3d2a15178.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="8"/>

<link href="/stylesheets/common_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="common"  />

  <link href="/stylesheets/desktop_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="/stylesheets/checklist_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="/stylesheets/discourse-details_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="/stylesheets/discourse-lazy-videos_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="/stylesheets/discourse-local-dates_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="/stylesheets/discourse-narrative-bot_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="/stylesheets/discourse-solved_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="/stylesheets/discourse-templates_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="/stylesheets/discourse-topic-voting_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="/stylesheets/docker_manager_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="/stylesheets/footnote_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="/stylesheets/poll_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="poll"  />
    <link href="/stylesheets/spoiler-alert_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="/stylesheets/discourse-topic-voting_desktop_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="/stylesheets/poll_desktop_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="/stylesheets/common_theme_12_608350f9691b80d810a6d8eaf4a08f6acc589e94.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="12" data-theme-name="erpnext"/>
    <link href="/stylesheets/desktop_theme_12_1843eada91b7bd1c5a6c17799765c3af197a4c6e.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="12" data-theme-name="erpnext"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth&#39;" href="https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003.rss" />
    <meta property="og:site_name" content="Frappe Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://discuss.frappe.io/uploads/default/original/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30.png" />
<meta property="og:image" content="https://discuss.frappe.io/uploads/default/original/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30.png" />
<meta property="og:url" content="https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003" />
<meta name="twitter:url" content="https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003" />
<meta property="og:title" content="[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth" />
<meta name="twitter:title" content="[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth" />
<meta property="og:description" content="Hi:  To get connection between Frappe mail system and Microsoft365 mail services (formerly known as Office365) you will need:  Patience / faith üòÇ  1. Requirements.  Update Frappe to v14.23.0 and above or v13.55.0 and above. Best option is most recent version, because some minor fixes are included.  You will need a frappe site running under https (or localhost on dev environments).  M365 account and admin privileges to manage OAuth  2. Microsoft 365 side:  On Azure AD admin you will need to c..." />
<meta name="twitter:description" content="Hi:  To get connection between Frappe mail system and Microsoft365 mail services (formerly known as Office365) you will need:  Patience / faith üòÇ  1. Requirements.  Update Frappe to v14.23.0 and above or v13.55.0 and above. Best option is most recent version, because some minor fixes are included.  You will need a frappe site running under https (or localhost on dev environments).  M365 account and admin privileges to manage OAuth  2. Microsoft 365 side:  On Azure AD admin you will need to c..." />
<meta property="og:article:section" content="Frappe Framework" />
<meta property="og:article:section:color" content="F7941D" />
<meta property="og:article:tag" content="office" />
<meta property="og:article:tag" content="mail" />
<meta property="og:article:tag" content="tutorial" />
<meta property="og:article:tag" content="howto" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="10 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="55 ‚ù§" />
<meta property="article:published_time" content="2023-06-13T07:54:15+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="next" href="/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003?page=2">

    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth","mainEntity":{"@type":"Question","name":"[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth","text":"Hi:\n\nTo get connection between Frappe mail system and Microsoft365 mail services (formerly known as Office365) you will need:\n\nPatience / faith :joy:\n\n1. Requirements.\n\nUpdate Frappe to v14.23.0 and above or v13.55.0 and above. Best option is most recent version, because some minor fixes are include&hellip;","upvoteCount":30,"answerCount":0,"datePublished":"2023-06-13T07:54:15.304Z","author":{"@type":"Person","name":"avc","url":"https://discuss.frappe.io/u/avc"}}}</script>
  </head>
  <body class="crawler ">
    <div class="erpnext-header">
    <a href="https://frappe.io" target="_blank">Frappe.io</a>
    <a href="https://frappecloud.com" target="_blank">Frappe Cloud</a>
    <a href="https://docs.frappe.io/" target="_blank">Documentation</a>
    <a href="https://frappe.io/partners" target="_blank">Partners</a>
    <a href="https://frappe.school" target="_blank">Frappe School</a>
    <a href="https://frappecloud.com/marketplace" target="_blank">Marketplace</a>
    <a href="https://t.me/erpnext_public" target="_blank">Public Chat</a>
</div>

    <header>
  <a href="/">Frappe Forum</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003">[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="/c/framework/5" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F7941D'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Frappe Framework</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='https://discuss.frappe.io/tag/office' class='discourse-tag' rel="tag">office</a>, 
            <a href='https://discuss.frappe.io/tag/mail' class='discourse-tag' rel="tag">mail</a>, 
            <a href='https://discuss.frappe.io/tag/tutorial' class='discourse-tag' rel="tag">tutorial</a>, 
            <a href='https://discuss.frappe.io/tag/howto' class='discourse-tag' rel="tag">howto</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth'>
      <link itemprop='url' href='https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003'>
      <meta itemprop='datePublished' content='2023-06-13T07:54:15Z'>
        <meta itemprop='articleSection' content='Frappe Framework'>
      <meta itemprop='keywords' content='office, mail, tutorial, howto'>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='Frappe'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://discuss.frappe.io/uploads/default/original/3X/e/1/e1295d1f76ba489dd58f8c9b55eee88286fc9a31.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/avc'><span itemprop='name'>avc</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003">

                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30.png">

              <span class="crawler-post-infos">
                  <time  datetime='2023-06-13T07:54:15Z' class='post-time'>
                    June 13, 2023,  7:54am
                  </time>
                  <meta itemprop='dateModified' content='2023-06-13T08:08:39Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi:</p>
<p>To get connection between Frappe mail system and Microsoft365 mail services (formerly known as Office365) you will need:</p>
<p>Patience / faith <img src="https://discuss.frappe.io/images/emoji/twitter/joy.png?v=12" title=":joy:" class="emoji" alt=":joy:" loading="lazy" width="20" height="20"></p>
<p><strong>1. Requirements.</strong></p>
<p>Update Frappe to v14.23.0 and above or v13.55.0 and above. Best option is most recent version, because some minor fixes are included.</p>
<p>You will need a frappe site running under https (or localhost on dev environments).</p>
<p>M365 account and admin privileges to manage OAuth</p>
<p><strong>2. Microsoft 365 side:</strong></p>
<p>On Azure AD admin you will need to create an App Registration, and configure here permissions, secrets, etc ‚Ä¶ Please, note that this kind of configuration could affect your data security.</p>
<p>2.a. App registration.</p>
<p>2.a.1 Access to your Azure Admin Portal<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30.png" data-download-href="https://discuss.frappe.io/uploads/default/65b7e6acf73b891a418a8a568acd71cca4480c30" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30_2_690x444.png" alt="image" data-base62-sha1="evQej1pCBEUNA5RB40yp6A2qLaU" width="690" height="444" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30_2_690x444.png, https://discuss.frappe.io/uploads/default/original/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/6/5/65b7e6acf73b891a418a8a568acd71cca4480c30.png 2x" data-dominant-color="E8F0F6"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó570 138 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.a.2 Use App registrations options<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/3/3/338121c65d5137cc3f76a801669a12e1b0c932f5.png" data-download-href="https://discuss.frappe.io/uploads/default/338121c65d5137cc3f76a801669a12e1b0c932f5" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/3/3/338121c65d5137cc3f76a801669a12e1b0c932f5_2_690x314.png" alt="image" data-base62-sha1="7lD0Vd9GIRHXe7MqEYeEkdNn60B" width="690" height="314" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/3/3/338121c65d5137cc3f76a801669a12e1b0c932f5_2_690x314.png, https://discuss.frappe.io/uploads/default/original/3X/3/3/338121c65d5137cc3f76a801669a12e1b0c932f5.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/3/3/338121c65d5137cc3f76a801669a12e1b0c932f5.png 2x" data-dominant-color="F0F4F8"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó403 70.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.a.3 Create new registration. Don‚Äôt worry about URI redirects, we will configure it further.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/d/5/d55d2a7cd28cb644dadfb1c502de2e5973d3a915.png" data-download-href="https://discuss.frappe.io/uploads/default/d55d2a7cd28cb644dadfb1c502de2e5973d3a915" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/d/5/d55d2a7cd28cb644dadfb1c502de2e5973d3a915_2_487x499.png" alt="image" data-base62-sha1="urvj7n7NPn6OIH0Iti7r4t8WIQZ" width="487" height="499" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/d/5/d55d2a7cd28cb644dadfb1c502de2e5973d3a915_2_487x499.png, https://discuss.frappe.io/uploads/default/optimized/3X/d/5/d55d2a7cd28cb644dadfb1c502de2e5973d3a915_2_730x748.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/d/5/d55d2a7cd28cb644dadfb1c502de2e5973d3a915.png 2x" data-dominant-color="F9FBFC"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">886√ó908 76.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.a.4 Add permissions to the app registration. You will need IMAP.AccessAsUser.All and SMTP.Send from Microsoft Graph and IMAP.AccessAsApp from Office365 Exchange on line<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/5/a/5a3b8e9665b46a34bde30d632f348b3ee413c0a6.png" data-download-href="https://discuss.frappe.io/uploads/default/5a3b8e9665b46a34bde30d632f348b3ee413c0a6" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/5/a/5a3b8e9665b46a34bde30d632f348b3ee413c0a6_2_690x385.png" alt="image" data-base62-sha1="cSezv1r9D8AvwUlXbMAh04Y1Vcy" width="690" height="385" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/5/a/5a3b8e9665b46a34bde30d632f348b3ee413c0a6_2_690x385.png, https://discuss.frappe.io/uploads/default/original/3X/5/a/5a3b8e9665b46a34bde30d632f348b3ee413c0a6.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/5/a/5a3b8e9665b46a34bde30d632f348b3ee413c0a6.png 2x" data-dominant-color="F1F1F4"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">885√ó495 109 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>After that, select each permission required and grant admin consent for them.</p>
<p>2.a.5 Copy the app client ID, is needed to configure Frappe side.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/5/6/563de4e9dd738b7a5c65be45154d9939868e8d4a.png" data-download-href="https://discuss.frappe.io/uploads/default/563de4e9dd738b7a5c65be45154d9939868e8d4a" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/5/6/563de4e9dd738b7a5c65be45154d9939868e8d4a_2_690x391.png" alt="image" data-base62-sha1="ciVFy55bPRkv0rAgRDqPCwYC6aS" width="690" height="391" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/5/6/563de4e9dd738b7a5c65be45154d9939868e8d4a_2_690x391.png, https://discuss.frappe.io/uploads/default/original/3X/5/6/563de4e9dd738b7a5c65be45154d9939868e8d4a.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/5/6/563de4e9dd738b7a5c65be45154d9939868e8d4a.png 2x" data-dominant-color="F4F5F6"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó502 127 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.a.6 Create your secrets (keys). Copy the secret value (not the secret ID) (after this step this value will be not showed again). We will use this data further.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/5/c/5ca50e058c1555a87bcb6ed47a1815e52b787d52.png" data-download-href="https://discuss.frappe.io/uploads/default/5ca50e058c1555a87bcb6ed47a1815e52b787d52" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/5/c/5ca50e058c1555a87bcb6ed47a1815e52b787d52_2_690x370.png" alt="image" data-base62-sha1="ddzyrl8qIt47awA4OuGWt6c8j06" width="690" height="370" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/5/c/5ca50e058c1555a87bcb6ed47a1815e52b787d52_2_690x370.png, https://discuss.frappe.io/uploads/default/original/3X/5/c/5ca50e058c1555a87bcb6ed47a1815e52b787d52.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/5/c/5ca50e058c1555a87bcb6ed47a1815e52b787d52.png 2x" data-dominant-color="FAF8F9"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó475 79 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.a.7 Get the OpenID configuration endpoint, we will need this in following steps.<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/a/c/acb494e027c6e635843dee5bd28bff95f89eb228.png" data-download-href="https://discuss.frappe.io/uploads/default/acb494e027c6e635843dee5bd28bff95f89eb228" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/a/c/acb494e027c6e635843dee5bd28bff95f89eb228_2_690x324.png" alt="image" data-base62-sha1="oDP1boAglqMnc9lFceYSSVVTMKc" width="690" height="324" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/a/c/acb494e027c6e635843dee5bd28bff95f89eb228_2_690x324.png, https://discuss.frappe.io/uploads/default/original/3X/a/c/acb494e027c6e635843dee5bd28bff95f89eb228.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/a/c/acb494e027c6e635843dee5bd28bff95f89eb228.png 2x" data-dominant-color="F1F0F1"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó416 89 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p><strong>On Frappe Side</strong><br>
2.b.1 Create a connected app (<a href="http://yoursite.com/app/connected-app">yoursite.com/app/connected-app</a>) .</p>
<p>2.b.2 Copy the value of OpenID Configuration obtained before (2.a.7), and use ‚ÄúGet OpenID Configuration‚Äù button. this will get the endpoints urls. Now, fill Client ID (2.a.5) and secret value (2.a.6)<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/a/5/a5bb60c2f9ab44cf4fbcbe822d42e939d9028d23.png" data-download-href="https://discuss.frappe.io/uploads/default/a5bb60c2f9ab44cf4fbcbe822d42e939d9028d23" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/a/5/a5bb60c2f9ab44cf4fbcbe822d42e939d9028d23_2_690x479.png" alt="image" data-base62-sha1="nE8eLc8ug5eBDYRMH4bSjjPbO0z" width="690" height="479" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/a/5/a5bb60c2f9ab44cf4fbcbe822d42e939d9028d23_2_690x479.png, https://discuss.frappe.io/uploads/default/original/3X/a/5/a5bb60c2f9ab44cf4fbcbe822d42e939d9028d23.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/a/5/a5bb60c2f9ab44cf4fbcbe822d42e939d9028d23.png 2x" data-dominant-color="F9F6F7"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó614 89.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.b.3 Add this scopes<br>
<a href="https://outlook.office365.com/.default" class="onebox" target="_blank" rel="noopener">https://outlook.office365.com/.default</a><br>
offline_access<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/c/1/c10f5f5cb35bfa30907545c85c0e16ac7eda051e.png" data-download-href="https://discuss.frappe.io/uploads/default/c10f5f5cb35bfa30907545c85c0e16ac7eda051e" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/c/1/c10f5f5cb35bfa30907545c85c0e16ac7eda051e_2_690x260.png" alt="image" data-base62-sha1="rxT5pmC8XwXFqk1SKC6zvJ6fN7w" width="690" height="260" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/c/1/c10f5f5cb35bfa30907545c85c0e16ac7eda051e_2_690x260.png, https://discuss.frappe.io/uploads/default/original/3X/c/1/c10f5f5cb35bfa30907545c85c0e16ac7eda051e.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/c/1/c10f5f5cb35bfa30907545c85c0e16ac7eda051e.png 2x" data-dominant-color="FCF7F7"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">886√ó334 32.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.b.4 Copy the value ‚ÄúRedirect URI‚Äù<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/b/8/b893e8a630660fca729700e5b59c868f7b40d259.png" data-download-href="https://discuss.frappe.io/uploads/default/b893e8a630660fca729700e5b59c868f7b40d259" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/b/8/b893e8a630660fca729700e5b59c868f7b40d259_2_690x313.png" alt="image" data-base62-sha1="qkQKm3Q4xrSzS1ubgTMgPQvDdBT" width="690" height="313" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/b/8/b893e8a630660fca729700e5b59c868f7b40d259_2_690x313.png, https://discuss.frappe.io/uploads/default/original/3X/b/8/b893e8a630660fca729700e5b59c868f7b40d259.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/b/8/b893e8a630660fca729700e5b59c868f7b40d259.png 2x" data-dominant-color="FAF8F8"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó402 42.2 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.b.5 Use the Redirect URI value (2.b.4) and back to Registration App on M365 side, to add this url to authentication<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/b/0/b012ebba866d3d18ef16572c8aa2913637ddbf15.png" data-download-href="https://discuss.frappe.io/uploads/default/b012ebba866d3d18ef16572c8aa2913637ddbf15" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/b/0/b012ebba866d3d18ef16572c8aa2913637ddbf15_2_690x491.png" alt="image" data-base62-sha1="p7CzuwLEg5oOcInprhZAghJP3Rr" width="690" height="491" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/b/0/b012ebba866d3d18ef16572c8aa2913637ddbf15_2_690x491.png, https://discuss.frappe.io/uploads/default/original/3X/b/0/b012ebba866d3d18ef16572c8aa2913637ddbf15.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/b/0/b012ebba866d3d18ef16572c8aa2913637ddbf15.png 2x" data-dominant-color="F9F9F8"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">884√ó630 126 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>2.b.6 Back on Frappe side connected app, use "Connect to ‚Äúyourconnectedapp‚Äù button<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/9/8/98e5a09038f94675222c32d2d7d5c40be61d45a3.png" data-download-href="https://discuss.frappe.io/uploads/default/98e5a09038f94675222c32d2d7d5c40be61d45a3" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/9/8/98e5a09038f94675222c32d2d7d5c40be61d45a3_2_690x205.png" alt="image" data-base62-sha1="lOAy4ldB2hJWlpwC7HWzTfAwSd5" width="690" height="205" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/9/8/98e5a09038f94675222c32d2d7d5c40be61d45a3_2_690x205.png, https://discuss.frappe.io/uploads/default/original/3X/9/8/98e5a09038f94675222c32d2d7d5c40be61d45a3.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/9/8/98e5a09038f94675222c32d2d7d5c40be61d45a3.png 2x" data-dominant-color="FAFAFA"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">886√ó264 41.1 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p><strong>Important:</strong> Use button ‚ÄúConnect‚Äù once logged on Frappe with the ‚Äúfinal‚Äù user (not Administrator). At this point M365 will ask you for authorization.</p>
<p>2.b.7 Create an email account on Frappe and assign it to the ‚Äúfinal‚Äù user.<br>
Configure this way ‚Ä¶<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/f/2/f26764c746f7213629393000a82a59263cd55160.png" data-download-href="https://discuss.frappe.io/uploads/default/f26764c746f7213629393000a82a59263cd55160" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/f/2/f26764c746f7213629393000a82a59263cd55160_2_690x483.png" alt="image" data-base62-sha1="yAp4cs7ijUM4RAE77nolxu4ohHO" width="690" height="483" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/f/2/f26764c746f7213629393000a82a59263cd55160_2_690x483.png, https://discuss.frappe.io/uploads/default/original/3X/f/2/f26764c746f7213629393000a82a59263cd55160.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/f/2/f26764c746f7213629393000a82a59263cd55160.png 2x" data-dominant-color="F9F6F6"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">886√ó621 101 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p><strong>Important:</strong> Use button ‚ÄúAuthorize API access‚Äù once logged on Frappe with the ‚Äúfinal‚Äù user (not Administrator) .</p>
<p>Hope this helps!</p>
<p>(Note: This post will be edited with other contributions, probably there are a lot of scenarios and different configuration posibilities. Please, let me know if you find any wrong information)</p>
<p>OAuth for M365 is working thanks to the efforts of <a href="https://discuss.frappe.io/u/revant_one">@revant_one</a>, <a href="https://discuss.frappe.io/u/ritwik">@ritwik</a>, <a href="https://discuss.frappe.io/u/ankush">@ankush</a> and others.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="30" />
              <span class='post-likes'>30 Likes</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/configuring-an-office-365-account-with-oauth/108330/2">Configuring an Office 365 account with OAuth</a>
                        <meta itemprop='position' content='16'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/office-365-e-mail-not-working-but-gmail-is/106449/4">Office 365 E-Mail not working, but Gmail is</a>
                        <meta itemprop='position' content='17'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/smtp-server-integration/107359/2">SMTP server integration</a>
                        <meta itemprop='position' content='18'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/how-to-create-the-app-password-for-microsoft-account/108616/2">How to create the App password for Microsoft account</a>
                        <meta itemprop='position' content='19'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/incoming-emails-not-received-by-users/106123/4">Incoming emails not received by users</a>
                        <meta itemprop='position' content='20'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/oauth-setup-for-email-with-outlook/114098/2">OAuth Setup for Email with Outlook</a>
                        <meta itemprop='position' content='21'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/frappe-erpnext-v15-office-365-integration/118602/2">Frappe / erpnext v15 office 365 integration</a>
                        <meta itemprop='position' content='22'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/microsoft-365-authentiication-error/132731">Microsoft 365 Authentiication Error</a>
                        <meta itemprop='position' content='23'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/microsoft-email-authentication-failed-while-setting-up-for-user/119990/2">Microsoft Email Authentication Failed while setting up for User</a>
                        <meta itemprop='position' content='24'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/modern-authentication-methods-for-office-365-and-outlook/86731/5">Modern Authentication Methods for Office 365 and Outlook</a>
                        <meta itemprop='position' content='25'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/how-to-configure-microsoft-account-by-oauth-in-erpnext/133603/2">How to configure microsoft account by oauth in erpnext</a>
                        <meta itemprop='position' content='26'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/how-to-add-outook-email/124380/2">How to add outook email</a>
                        <meta itemprop='position' content='27'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/how-can-i-setup-email-account-for-incoming-email-using-microsoft-365-for-method-oauth/120986/2">How can i setup email account for incoming email using microsoft 365 for method oauth</a>
                        <meta itemprop='position' content='28'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/microsoft-auth-by-connected-app-how-to-add-login-button/135168">Microsoft auth by connected app -&gt; How to add login button?</a>
                        <meta itemprop='position' content='29'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/outlook-email-setup/121455/3">Outlook email setup</a>
                        <meta itemprop='position' content='30'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/issue-with-smtp-setup-using-office-365/145535/2">Issue with SMTP Setup Using Office 365</a>
                        <meta itemprop='position' content='31'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/microsoft-365-incoming-server-issue/132390">Microsoft 365 Incoming Server Issue </a>
                        <meta itemprop='position' content='32'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/error-configuring-email-in-erpnext-with-office-365/152535/2">Error Configuring Email in ERPNext with Office 365</a>
                        <meta itemprop='position' content='33'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/config-the-office-365-in-erpnext-v15/152552/2">Config the office 365 in erpnext v15</a>
                        <meta itemprop='position' content='34'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/enabling-https-on-docker-desktop/157098">Enabling https on Docker Desktop</a>
                        <meta itemprop='position' content='35'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/how-to-create-app-password-from-outlook-for-email-configuration/127242/3">How to create app password from outlook for email configuration</a>
                        <meta itemprop='position' content='36'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/error-while-setting-up-outlook-email-account/124376/4">Error while setting up Outlook email account</a>
                        <meta itemprop='position' content='37'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/rmeyer'><span itemprop='name'>rmeyer</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-06-19T17:13:47Z' class='post-time'>
                    June 19, 2023,  5:13pm
                  </time>
                  <meta itemprop='dateModified' content='2023-06-19T17:13:47Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/avc">@avc</a> could you share how you have configured the rest of the <strong>Email Account</strong>? When I enable ‚ÄúUse TLS‚Äù the validation fails, but when I disable it, I get a ‚ÄúTLS required‚Äù error when sending an email.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/avc'><span itemprop='name'>avc</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/1/d/1d1ab63b986704b9f71e27f3993ba59e9715f3c0.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-06-19T17:31:08Z' class='post-time'>
                    June 19, 2023,  5:31pm
                  </time>
                  <meta itemprop='dateModified' content='2023-06-19T17:31:08Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="/u/rmeyer">@rmeyer</a>:</p>
<p>In my case, i use domain configuration, so email account has no comm options:</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/1/d/1d1ab63b986704b9f71e27f3993ba59e9715f3c0.png" data-download-href="https://discuss.frappe.io/uploads/default/1d1ab63b986704b9f71e27f3993ba59e9715f3c0" title="image"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/1/d/1d1ab63b986704b9f71e27f3993ba59e9715f3c0_2_690x332.png" alt="image" data-base62-sha1="49t4K6HGPnj80gilWGZf5iVLGTK" width="690" height="332" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/1/d/1d1ab63b986704b9f71e27f3993ba59e9715f3c0_2_690x332.png, https://discuss.frappe.io/uploads/default/optimized/3X/1/d/1d1ab63b986704b9f71e27f3993ba59e9715f3c0_2_1035x498.png 1.5x, https://discuss.frappe.io/uploads/default/optimized/3X/1/d/1d1ab63b986704b9f71e27f3993ba59e9715f3c0_2_1380x664.png 2x" data-dominant-color="FCFCFC"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1393√ó671 35.6 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Theorically, account inherits from this.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/rmeyer'><span itemprop='name'>rmeyer</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/3/4/344c78d997859e28c88f1f0c2359957dbe2b62ef.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-06-20T10:04:21Z' class='post-time'>
                    June 20, 2023, 10:04am
                  </time>
                  <meta itemprop='dateModified' content='2023-06-20T10:04:21Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>The last bit, that was missing for me, was that I got this error message when trying to send an email:</p>
<blockquote>
<p>5.7.139 Authentication unsuccessful, SmtpClientAuthentication is disabled for the Tenant. Visit <a href="https://aka.ms/smtp_auth_disabled" class="inline-onebox">Enable or disable SMTP AUTH in Exchange Online | Microsoft Learn</a> for more information.</p>
</blockquote>
<p>I was able to resolve this by enabling SMTP Auth as described in the link above.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/3/4/344c78d997859e28c88f1f0c2359957dbe2b62ef.png" data-download-href="https://discuss.frappe.io/uploads/default/344c78d997859e28c88f1f0c2359957dbe2b62ef" title="microsoft enable SMTP auth"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/3/4/344c78d997859e28c88f1f0c2359957dbe2b62ef_2_690x334.png" alt="microsoft enable SMTP auth" data-base62-sha1="7sEFu5zWoJ6Pqjni2xd1eDkAbiD" width="690" height="334" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/3/4/344c78d997859e28c88f1f0c2359957dbe2b62ef_2_690x334.png, https://discuss.frappe.io/uploads/default/optimized/3X/3/4/344c78d997859e28c88f1f0c2359957dbe2b62ef_2_1035x501.png 1.5x, https://discuss.frappe.io/uploads/default/optimized/3X/3/4/344c78d997859e28c88f1f0c2359957dbe2b62ef_2_1380x668.png 2x" data-dominant-color="FAFAFA"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">microsoft enable SMTP auth</span><span class="informations">1913√ó927 101 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Apparently this is still required, even when using OAuth:</p>
<blockquote>
<p>The SMTP AUTH protocol is used for SMTP client email submissions, typically on TCP port 587. SMTP AUTH supports modern authentication (Modern Auth) through OAuth in addition to basic authentication.</p>
</blockquote>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/email-authentication-oauth-m365-exchange-online/95640/18">Email authentication Oauth M365 / Exchange Online</a>
                        <meta itemprop='position' content='3'>
                      </div>
                </div>
          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/saurabhn'><span itemprop='name'>saurabhn</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-06-27T14:57:22Z' class='post-time'>
                    June 27, 2023,  2:57pm
                  </time>
                  <meta itemprop='dateModified' content='2023-06-27T14:57:22Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Firstly, thanks a ton. This is the first guide that seems to make the functionality work!<br>
I am able to fetch now for a 365 user.</p>
<p>My question is how do we use this to configure emails like sales (<a href="mailto:sales@domain.com">sales@domain.com</a>), job which don‚Äôt directly map to particular ERPNext users. Do we just create fake users for them in ERPNext or is there a way to may those email to some other user from sales team?</p>
<p>Thanks agiain for your help</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/rmeyer'><span itemprop='name'>rmeyer</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-06-27T18:52:56Z' class='post-time'>
                    June 27, 2023,  6:52pm
                  </time>
                  <meta itemprop='dateModified' content='2023-06-27T18:52:56Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>It should be no problem to configure generic emails. Try configuring the <strong>Email Account</strong> as follows:</p>
<ol>
<li>
<em>Email Address</em>: ‚Äú<a href="mailto:sales@example.com">sales@example.com</a>‚Äù</li>
<li>
<em>Connected User</em>: ‚Äú<a href="mailto:system-manager@example.com">system-manager@example.com</a>‚Äù</li>
<li>Make sure you‚Äôre logged out from microsoft with your personal account</li>
<li>Click ‚ÄúAuthorize API Access‚Äù and log into microsoft as <a href="mailto:sales@example.com">sales@example.com</a>
</li>
</ol>
<p>Once the <strong>Email Account</strong> is authenticated, you can grant any user access to this email account via their <strong>User</strong> DocType.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/eigene-domain-fur-e-mails-mit-mailserver-bei-all-inkl-com-anlegen/131219/2">Eigene Domain f√ºr E-Mails mit Mailserver bei All-Inkl.com anlegen</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/lmmena2'><span itemprop='name'>lmmena2</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/6/8/68e0e5e870c91970d256c1b52174c8ac08cad9ab.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-18T16:55:30Z' class='post-time'>
                    July 18, 2023,  4:55pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-18T16:55:30Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I am configuring everything the same, but I get this error when I try to connect. Do you know what could be happening?</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/6/8/68e0e5e870c91970d256c1b52174c8ac08cad9ab.png" data-download-href="https://discuss.frappe.io/uploads/default/68e0e5e870c91970d256c1b52174c8ac08cad9ab" title="image"><img src="https://discuss.frappe.io/uploads/default/original/3X/6/8/68e0e5e870c91970d256c1b52174c8ac08cad9ab.png" alt="image" data-base62-sha1="eXNuVwJmw8OkGfMxZBsmaWe9cf1" width="690" height="305" data-dominant-color="D6D6DB"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">907√ó401 9.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/muslimaziran'><span itemprop='name'>muslimaziran</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-20T02:43:57Z' class='post-time'>
                    July 20, 2023,  2:43am
                  </time>
                  <meta itemprop='dateModified' content='2023-07-20T02:43:57Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is brilliant <a class="mention" href="/u/avc">@avc</a>. Thank you so much.</p>
<p>I was able to follow thru the steps and don‚Äôt face any issues till I reach the state where I have setup a new email account for a person based on OAuth. Here it gives me the error Invalid Credentials, Please check your email login credentials.</p>
<p>I cannot figure out what credentials is it referring to.</p>
<p>Please guide.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/muslimaziran'><span itemprop='name'>muslimaziran</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/c/e/cea85b0cb9137965fac35177523acd16ec06189c.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-20T02:50:57Z' class='post-time'>
                    July 20, 2023,  2:50am
                  </time>
                  <meta itemprop='dateModified' content='2023-07-20T02:50:57Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><img src="https://discuss.frappe.io/uploads/default/original/3X/c/e/cea85b0cb9137965fac35177523acd16ec06189c.png" alt="image" data-base62-sha1="tub3FMx1AbTG6geghywX4uRoBbe" width="556" height="107"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/avc'><span itemprop='name'>avc</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-20T18:29:55Z' class='post-time'>
                    July 20, 2023,  6:29pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-20T18:29:55Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="/u/muslimaziran">@muslimaziran</a>:</p>
<p>Is this mail account linked to a connected app?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_11' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/muslimaziran'><span itemprop='name'>muslimaziran</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-21T13:48:50Z' class='post-time'>
                    July 21, 2023,  1:48pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-21T13:48:50Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Yes,<br>
so first I created a M365 user with the email address that I am interested to use as a default sending email in ERPNext. Then I created a user with the same email address in ERPNext. On logging in as this user I went to the conneted app and used the Connect to M365 (name of app). It asked me to log into the M365 account, I successfully logged into the account.</p>
<p>Then I created the email address for the same user but it gives the above error.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_12' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-21T14:49:15Z' class='post-time'>
                    July 21, 2023,  2:49pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-21T14:49:15Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="avc" data-post="3" data-topic="106003">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://discuss.frappe.io/user_avatar/discuss.frappe.io/avc/48/55078_2.png" class="avatar"> avc:</div>
<blockquote>
<p>i use domain configuration</p>
</blockquote>
</aside>
<p>Try creating <code>Email Domain</code> and inherit from it into <code>Email Account</code>.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_13' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/thomasr'><span itemprop='name'>thomasr</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-26T14:35:40Z' class='post-time'>
                    July 26, 2023,  2:35pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-26T14:35:40Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks for this in-depth tutorial! It sums up perfectly what I found out by searching multiple threads and issues. The official documentation on this topic is basically useless or not existing! Maybe we can extend it a little further and place it in the official frappe docs?</p>
<p>Anyways, I still have issues with the integration of emails with Office365 and ERPnext/frappe.</p>
<p>We use the Security Defaults provided by Microsoft, which state to ‚ÄúBlock legacy authentication methods, such as SMTP Auth‚Äù‚Ä¶ see: <a href="https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/concept-fundamentals-security-defaults#block-legacy-authentication-protocols" rel="noopener nofollow ugc">https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/concept-fundamentals-security-defaults#block-legacy-authentication-protocols</a></p>
<p>Did anybody get the email sending to work with Security Defaults enabled? Or am I required to use a Mail Connector for sending? see <a href="https://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/how-to-set-up-a-multifunction-device-or-application-to-send-email-using-microsoft-365-or-office-365#option-3-configure-a-connector-to-send-mail-using-microsoft-365-or-office-365-smtp-relay" rel="noopener nofollow ugc">https://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/how-to-set-up-a-multifunction-device-or-application-to-send-email-using-microsoft-365-or-office-365#option-3-configure-a-connector-to-send-mail-using-microsoft-365-or-office-365-smtp-relay</a></p>
<p>Thanks!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_14' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-26T21:33:54Z' class='post-time'>
                    July 26, 2023,  9:33pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-26T21:33:54Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Is it this step discussed here? <a href="https://discuss.frappe.io/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003/4" class="inline-onebox">[Tutorial] Connecting Frappe/ERPNext to Microsoft 365 mail services OAuth - #4 by rmeyer</a></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_15' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/avc'><span itemprop='name'>avc</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-27T15:03:56Z' class='post-time'>
                    July 27, 2023,  3:03pm
                  </time>
                  <meta itemprop='dateModified' content='2023-07-27T15:03:56Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi:</p>
<p>I was able to sending through SMTP even without OAuth ‚Ä¶ it‚Äôs still working disabling Security Defaults and  probably it will works for a long time ‚Ä¶)</p>
<p>Also is possible to activate/deactivate SMTPAuth on certain accounts (via Powershell)</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission">
  <header class="source">

      <a href="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission" target="_blank" rel="noopener">learn.microsoft.com</a>
  </header>

  <article class="onebox-body">
    <img src="https://learn.microsoft.com/en-us/media/logos/logo-ms-social.png" class="thumbnail onebox-avatar" width="400" height="400">

<h3><a href="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission" target="_blank" rel="noopener">Enable or disable SMTP AUTH in Exchange Online</a></h3>

  <p>Summary: An overview of SMTP AUTH in Exchange Online.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Anyway ‚Ä¶ STMPAuth isn‚Äôt needed since OAuth was implemented ‚Ä¶<br>
Hope this helps.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_16' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/thomasr'><span itemprop='name'>thomasr</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-07-28T06:35:56Z' class='post-time'>
                    July 28, 2023,  6:35am
                  </time>
                  <meta itemprop='dateModified' content='2023-07-28T06:35:56Z'>
              <span itemprop='position'>16</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Nope, that was not the issue.<br>
I created a new connected app and now its working.<br>
I followed the tutorial step by step. Maybe i missed something in the first run.</p>
<p>Great tutorial. Please move it over to the official docs for Connected Apps in Frappe</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_17' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/Khushal'><span itemprop='name'>Khushal</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/9/b/9ba54dd3cafb3039046d6ade3fb338815bc63216.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-08-08T17:00:31Z' class='post-time'>
                    August 8, 2023,  5:00pm
                  </time>
                  <meta itemprop='dateModified' content='2023-08-08T17:00:31Z'>
              <span itemprop='position'>17</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/avc">@avc</a> I follow all your steps and my incoming email is working completely fine but when I enable outgoing I am getting this error I can‚Äôt find where it was gone wrong</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/9/b/9ba54dd3cafb3039046d6ade3fb338815bc63216.png" data-download-href="https://discuss.frappe.io/uploads/default/9ba54dd3cafb3039046d6ade3fb338815bc63216" title="Screenshot 2023-08-08 at 10.30.09 PM"><img src="https://discuss.frappe.io/uploads/default/optimized/3X/9/b/9ba54dd3cafb3039046d6ade3fb338815bc63216_2_690x170.png" alt="Screenshot 2023-08-08 at 10.30.09 PM" data-base62-sha1="mcUaxZGNPSXkTZP9OIcsSUJScpU" width="690" height="170" srcset="https://discuss.frappe.io/uploads/default/optimized/3X/9/b/9ba54dd3cafb3039046d6ade3fb338815bc63216_2_690x170.png, https://discuss.frappe.io/uploads/default/original/3X/9/b/9ba54dd3cafb3039046d6ade3fb338815bc63216.png 1.5x, https://discuss.frappe.io/uploads/default/original/3X/9/b/9ba54dd3cafb3039046d6ade3fb338815bc63216.png 2x" data-dominant-color="DADBDC"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2023-08-08 at 10.30.09 PM</span><span class="informations">759√ó187 13.5 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_18' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/avc'><span itemprop='name'>avc</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-08-08T18:46:33Z' class='post-time'>
                    August 8, 2023,  6:46pm
                  </time>
                  <meta itemprop='dateModified' content='2023-08-08T18:46:33Z'>
              <span itemprop='position'>18</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi:</p>
<p>Check the permissions of your M365 user.<br>
Can use SMTP?</p>
<p>Hope this helps.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_20' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/Khushal'><span itemprop='name'>Khushal</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/9/4/9470342de43f37c20f05e133adcc36dc17288833.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-08-09T18:06:42Z' class='post-time'>
                    August 9, 2023,  6:06pm
                  </time>
                  <meta itemprop='dateModified' content='2023-08-09T18:06:42Z'>
              <span itemprop='position'>20</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I did OAuth for Office 365 and after It didn‚Äôt required to enable or disable SMTP AUTH but when I enable outgoing i got this error<br>
<div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/9/4/9470342de43f37c20f05e133adcc36dc17288833.png" data-download-href="https://discuss.frappe.io/uploads/default/9470342de43f37c20f05e133adcc36dc17288833" title="Screenshot 2023-08-09 at 11.15.20 PM"><img src="https://discuss.frappe.io/uploads/default/original/3X/9/4/9470342de43f37c20f05e133adcc36dc17288833.png" alt="Screenshot 2023-08-09 at 11.15.20 PM" data-base62-sha1="lb93NiRfY2E3EGwY6dScVe8iuST" width="690" height="64" data-dominant-color="E8E9EA"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">Screenshot 2023-08-09 at 11.15.20 PM</span><span class="informations">1238√ó116 16.4 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_21' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/avc'><span itemprop='name'>avc</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-08-09T21:51:39Z' class='post-time'>
                    August 9, 2023,  9:51pm
                  </time>
                  <meta itemprop='dateModified' content='2023-08-09T21:51:39Z'>
              <span itemprop='position'>21</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi:</p>
<p>Have you checked this?</p><aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission">
  <header class="source">

      <a href="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission" target="_blank" rel="noopener">learn.microsoft.com</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/361;"><img src="https://learn.microsoft.com/en-us/media/open-graph-image.png" class="thumbnail" width="690" height="361"></div>

<h3><a href="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission" target="_blank" rel="noopener">Enable or disable SMTP AUTH in Exchange Online</a></h3>

  <p>Summary: An overview of SMTP AUTH in Exchange Online.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
            <span itemprop='name'><b><a rel="next" itemprop="url" href="/t/tutorial-connecting-frappe-erpnext-to-microsoft-365-mail-services-oauth/106003?page=2">next page ‚Üí</a></b></span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="erpnext-footer">
    <a href="https://frappe.io">Frappe</a>
</div>
    
  </body>
  
</html>
