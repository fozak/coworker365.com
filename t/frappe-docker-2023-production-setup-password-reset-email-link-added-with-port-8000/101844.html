<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Frappe Docker 2023 Production setup: Password reset email link added with port 8000 - ERPNext - Frappe Forum</title>
    <meta name="description" content="All these days we were using frappe docker 2022 single server setup. My existing 2022 instance all work fine till date. Thanks to the frappe docker community. 
I noticed 2023 upgrade in frappe docker which sounded to me &amp;hellip;">
    <meta name="generator" content="Discourse 3.5.2 - https://github.com/discourse/discourse version 44986e4c0c3acf127ce03216227dd11cc78f4466">
<link rel="icon" type="image/png" href="https://discuss.frappe.io/uploads/default/optimized/3X/a/5/a5e946e67fbe05a61d1c33d08894876d4d9dea7a_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="https://discuss.frappe.io/uploads/default/optimized/3X/a/5/a5e946e67fbe05a61d1c33d08894876d4d9dea7a_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="https://discuss.frappe.io/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844" />

<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.frappe.io/opensearch.xml" title="Frappe Forum Search">

    <link href="/stylesheets/color_definitions_light_8_12_296e8563dbd3c739bd4eafc35307bea3d2a15178.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" class="light-scheme" data-scheme-id="8"/>

<link href="/stylesheets/common_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="common"  />

  <link href="/stylesheets/desktop_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="/stylesheets/checklist_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="/stylesheets/discourse-details_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="/stylesheets/discourse-lazy-videos_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="/stylesheets/discourse-local-dates_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="/stylesheets/discourse-narrative-bot_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="/stylesheets/discourse-solved_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="/stylesheets/discourse-templates_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="/stylesheets/discourse-topic-voting_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="/stylesheets/docker_manager_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="/stylesheets/footnote_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="/stylesheets/poll_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="poll"  />
    <link href="/stylesheets/spoiler-alert_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="/stylesheets/discourse-topic-voting_desktop_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="/stylesheets/poll_desktop_eec39e19a85cf59c80446f577a88d854b2ec7e58.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="/stylesheets/common_theme_12_608350f9691b80d810a6d8eaf4a08f6acc589e94.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="12" data-theme-name="erpnext"/>
    <link href="/stylesheets/desktop_theme_12_1843eada91b7bd1c5a6c17799765c3af197a4c6e.css?__ws=discuss.frappe.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="12" data-theme-name="erpnext"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Frappe Docker 2023 Production setup: Password reset email link added with port 8000&#39;" href="https://discuss.frappe.io/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844.rss" />
    <meta property="og:site_name" content="Frappe Forum" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://discuss.frappe.io/uploads/default/original/3X/0/b/0b28794440eb26973e11119effb9e80dcb726e09.png" />
<meta property="og:image" content="https://discuss.frappe.io/uploads/default/original/3X/0/b/0b28794440eb26973e11119effb9e80dcb726e09.png" />
<meta property="og:url" content="https://discuss.frappe.io/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844" />
<meta name="twitter:url" content="https://discuss.frappe.io/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844" />
<meta property="og:title" content="Frappe Docker 2023 Production setup: Password reset email link added with port 8000" />
<meta name="twitter:title" content="Frappe Docker 2023 Production setup: Password reset email link added with port 8000" />
<meta property="og:description" content="All these days we were using frappe docker 2022 single server setup. My existing 2022 instance all work fine till date. Thanks to the frappe docker community.  I noticed 2023 upgrade in frappe docker which sounded to me more flexible in terms of upgrades in future especially the assets.  We setup a new production instance based on the new changes outlined in Single server Example  Everything works like a charm except for the two issues.   All the links in emails such as password reset, unsubscri..." />
<meta name="twitter:description" content="All these days we were using frappe docker 2022 single server setup. My existing 2022 instance all work fine till date. Thanks to the frappe docker community.  I noticed 2023 upgrade in frappe docker which sounded to me more flexible in terms of upgrades in future especially the assets.  We setup a new production instance based on the new changes outlined in Single server Example  Everything works like a charm except for the two issues.   All the links in emails such as password reset, unsubscri..." />
<meta property="og:article:section" content="ERPNext" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta property="og:article:tag" content="docker" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="6 ‚ù§" />
<meta property="article:published_time" content="2023-03-02T05:43:24+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"Frappe Docker 2023 Production setup: Password reset email link added with port 8000","mainEntity":{"@type":"Question","name":"Frappe Docker 2023 Production setup: Password reset email link added with port 8000","text":"All these days we were using frappe docker 2022 single server setup. My existing 2022 instance all work fine till date. Thanks to the frappe docker community.\n\nI noticed 2023 upgrade in frappe docker which sounded to me more flexible in terms of upgrades in future especially the assets.\n\nWe setup a &hellip;","upvoteCount":0,"answerCount":0,"datePublished":"2023-03-02T05:43:24.420Z","author":{"@type":"Person","name":"gsarunk","url":"https://discuss.frappe.io/u/gsarunk"}}}</script>
  </head>
  <body class="crawler ">
    <div class="erpnext-header">
    <a href="https://frappe.io" target="_blank">Frappe.io</a>
    <a href="https://frappecloud.com" target="_blank">Frappe Cloud</a>
    <a href="https://docs.frappe.io/" target="_blank">Documentation</a>
    <a href="https://frappe.io/partners" target="_blank">Partners</a>
    <a href="https://frappe.school" target="_blank">Frappe School</a>
    <a href="https://frappecloud.com/marketplace" target="_blank">Marketplace</a>
    <a href="https://t.me/erpnext_public" target="_blank">Public Chat</a>
</div>

    <header>
  <a href="/">Frappe Forum</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844">Frappe Docker 2023 Production setup: Password reset email link added with port 8000</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="/c/erpnext/6" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #BF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>ERPNext</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='https://discuss.frappe.io/tag/docker' class='discourse-tag' rel="tag">docker</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Frappe Docker 2023 Production setup: Password reset email link added with port 8000'>
      <link itemprop='url' href='https://discuss.frappe.io/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844'>
      <meta itemprop='datePublished' content='2023-03-02T05:43:24Z'>
        <meta itemprop='articleSection' content='ERPNext'>
      <meta itemprop='keywords' content='docker'>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='Frappe'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://discuss.frappe.io/uploads/default/original/3X/e/1/e1295d1f76ba489dd58f8c9b55eee88286fc9a31.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="https://discuss.frappe.io/t/frappe-docker-2023-production-setup-password-reset-email-link-added-with-port-8000/101844">


              <span class="crawler-post-infos">
                  <time  datetime='2023-03-02T05:43:24Z' class='post-time'>
                    March 2, 2023,  5:43am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T05:45:25Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>All these days we were using frappe docker 2022 single server setup. My existing 2022 instance all work fine till date. Thanks to the frappe docker community.</p>
<p>I noticed 2023 upgrade in frappe docker which sounded to me more flexible in terms of upgrades in future especially the assets.</p>
<p>We setup a new production instance based on the new changes outlined in <a href="https://github.com/frappe/frappe_docker/blob/main/docs/single-server-example.md" rel="noopener nofollow ugc">Single server Example</a></p>
<p>Everything works like a charm except for the two issues.</p>
<ol>
<li>All the links in emails such as password reset, unsubscribe email link, document link are added with port 8000 like <a href="http://site1.mydomain.com:8000" rel="noopener nofollow ugc">site1.mydomain.com:8000</a>:api/method/frappe.email.queue.unsubscribe?..</li>
<li>Issuing pdf print is keeps spinning without any output. Also when Attach document print is enabled in the email, the email send ends with timeout error.<br>
And again port 8000 is added in the stylesheet</li>
</ol>
<pre><code class="lang-auto">
get_response_content = &lt;function get_response_content at 0x7f35b1bb76d0&gt;
href="http://bluemaple.lmnas.com:8000/assets/frappe/dist/css/print.bundle.V2BFJYQM.css" rel="stylesheet" type="text/css"/&gt;\n\t\n\t\t&lt;style&gt;\n\t\t@media screen {\n\t.print-format-gutter {\n\t\tbackground-color: #d1d8dd;\n\t\tpadding: 30px 0px;\n\t}\n\t.print-format {\n\t\tbackground-color: white;\n\t\tborder-radius: 8px;\n\t\tmax-width: 8.3in;\n\t\tmin-height: 11.69in;\n\t\tpadding: 0.75in;\n\t\tmargin: auto;\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.print-format.landscape {\n\t\tmax-width: 11.69in;\n\t\tpadding: 0.2in;\n\t}\n\n\t.page-break {\n\t\t/* padding: 15px 0px; */\n\t\tborder-bottom: 1px dashed #888;\n\t}\n\n\t/* .page-break:first-child {\n\t\tpadding-top: 0px;\n\t} */\n\n\t.page-break:last-child {\n\t\tborder-bot...
</code></pre>
<p>Not sure if this has something to do with treafik and related network configurations that were recently changed as part of 2023 upgrades</p>
<p>Help me how to get rid of the port 8000 addition in site url</p>
<p>Kind Regards,<br>
Arun</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/wkhtmltopdf-error-creating-pdf/101926/8">Wkhtmltopdf error creating PDF</a>
                        <meta itemprop='position' content='3'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/cannot-send-email-from-sales-order/102478/14">Cannot send email from Sales order</a>
                        <meta itemprop='position' content='4'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T05:47:08Z' class='post-time'>
                    March 2, 2023,  5:47am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T05:47:08Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>can you try adding host_name key with value as base url for your site including the http or https and no trailing slash in site_config.json</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/frappe-docker-oserror-wkhtmltopdf-reported-an-error-network-error-hostnotfounderror/101823/6">Frappe Docker OSError: wkhtmltopdf reported an error: network error: HostNotFoundError</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T05:53:44Z' class='post-time'>
                    March 2, 2023,  5:53am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T05:53:44Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I tried that with options like</p>
<ol>
<li><a href="https://site1.mydomain.com" rel="noopener nofollow ugc">https://site1.mydomain.com</a></li>
<li>127.0.0.1</li>
</ol>
<p>Both did not work</p>
<p>I will try again and share the outcome</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>


                <link itemprop="image" href="https://discuss.frappe.io/uploads/default/original/3X/7/1/71a2cf7dc1c71a027817109dda9ea5ab1521e847.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T06:28:26Z' class='post-time'>
                    March 2, 2023,  6:28am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T06:28:26Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="/u/revant_one">@revant_one</a> no luck after adding host_name to site_config.json</p>
<p>the site config now looks like this.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://discuss.frappe.io/uploads/default/original/3X/7/1/71a2cf7dc1c71a027817109dda9ea5ab1521e847.png" data-download-href="https://discuss.frappe.io/uploads/default/71a2cf7dc1c71a027817109dda9ea5ab1521e847" title="image"><img src="https://discuss.frappe.io/uploads/default/original/3X/7/1/71a2cf7dc1c71a027817109dda9ea5ab1521e847.png" alt="image" data-base62-sha1="gdgLZxPuXygGseBe5xBhnTzGyDd" width="690" height="139" data-dominant-color="2E2E2E"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">780√ó158 7.69 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T08:14:02Z' class='post-time'>
                    March 2, 2023,  8:14am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T08:22:11Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is the logic behind generating the link</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/frappe/frappe/blob/2a81365adb4ec24bafcd4472600c0f1f26e6c720/frappe/utils/data.py#L1543-L1597">
  <header class="source">

      <a href="https://github.com/frappe/frappe/blob/2a81365adb4ec24bafcd4472600c0f1f26e6c720/frappe/utils/data.py#L1543-L1597" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/frappe/frappe/blob/2a81365adb4ec24bafcd4472600c0f1f26e6c720/frappe/utils/data.py#L1543-L1597" target="_blank" rel="noopener">frappe/frappe/blob/2a81365adb4ec24bafcd4472600c0f1f26e6c720/frappe/utils/data.py#L1543-L1597</a></h4>



    <pre class="onebox"><code class="lang-py">
      <ol class="start lines" start="1543" style="counter-reset: li-counter 1542 ;">
          <li>def get_url(uri: str | None = None, full_address: bool = False) -&gt; str:</li>
          <li>	"""get app url from request"""</li>
          <li>	host_name = frappe.local.conf.host_name or frappe.local.conf.hostname</li>
          <li>
          </li>
<li>	if uri and (uri.startswith("http://") or uri.startswith("https://")):</li>
          <li>		return uri</li>
          <li>
          </li>
<li>	if not host_name:</li>
          <li>		request_host_name = get_host_name_from_request()</li>
          <li>
          </li>
<li>		if request_host_name:</li>
          <li>			host_name = request_host_name</li>
          <li>
          </li>
<li>		elif frappe.local.site:</li>
          <li>			protocol = "http://"</li>
          <li>
          </li>
<li>			if frappe.local.conf.ssl_certificate:</li>
          <li>				protocol = "https://"</li>
          <li>
          </li>
<li>			elif frappe.local.conf.wildcard:</li>
      </ol>
    </code></pre>


  This file has been truncated. <a href="https://github.com/frappe/frappe/blob/2a81365adb4ec24bafcd4472600c0f1f26e6c720/frappe/utils/data.py#L1543-L1597" target="_blank" rel="noopener">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T09:00:03Z' class='post-time'>
                    March 2, 2023,  9:00am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T09:00:03Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks <a class="mention" href="/u/revant_one">@revant_one</a><br>
Are the following lines responsible for this?</p>
<pre><code class="lang-auto">if (
		not (frappe.conf.restart_supervisor_on_update or frappe.conf.restart_systemd_on_update)
		and host_name
		and not url_contains_port(host_name)
		and port
	):
		host_name = host_name + ":" + str(port)
</code></pre>
<p>below are the common_site_config.json values</p>
<pre><code class="lang-auto">{
 "background_workers": 1,
 "db_host": "mariadb-database",
 "db_port": 3306,
 "file_watcher_port": 6787,
 "frappe_user": "frappe",
 "gunicorn_workers": 5,
 "live_reload": true,
 "rebase_on_pull": false,
 "redis_cache": "redis://redis-cache:6379",
 "redis_queue": "redis://redis-queue:6379",
 "redis_socketio": "redis://redis-socketio:6379",
 "restart_supervisor_on_update": false,
 "restart_systemd_on_update": false,
 "serve_default_site": true,
 "shallow_clone": true,
 "socketio_port": 9000,
 "use_redis_auth": false,
 "webserver_port": 8000
}
</code></pre>
<p>2022 common_site_config.json is looking like below</p>
<pre><code class="lang-auto">{
	"db_host": "mariadb-database",
	"db_port": 3306,
	"redis_cache": "redis://redis:6379/0",
	"redis_queue": "redis://redis:6379/1",
	"redis_socketio": "redis://redis:6379/2",
	"socketio_port": 9000
}
</code></pre>
<p>will  removing the two params from the config file solve the problem ?<br>
‚Äúrestart_supervisor_on_update‚Äù: false,<br>
‚Äúrestart_systemd_on_update‚Äù: false,</p>
<p>Kind Regards,<br>
Arun</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T09:12:30Z' class='post-time'>
                    March 2, 2023,  9:12am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T09:12:30Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>you can copy your old configs and they should work.</p>
<p>the difference is because now sites directory is specified as <code>VOLUME</code> during image build. It has the default generated common_site_config.json whereas in old setup the volumes were blank and these files were generated from no base config.</p>
<p>check the difference in PWD config and your setup to debug further.</p>
<p>I think copying old configs over should work.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T09:26:25Z' class='post-time'>
                    March 2, 2023,  9:26am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T09:26:25Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks <a class="mention" href="/u/revant_one">@revant_one</a>,<br>
Finally it worked,<br>
I updated these two params to true and left others as it is.<br>
‚Äúrestart_supervisor_on_update‚Äù: true,<br>
‚Äúrestart_systemd_on_update‚Äù: true,</p>
<p>However I will refer to pwd as well.<br>
But is this a global issue or only happened to me</p>
<p>What is the impact on making these two params true?. Can we root cause?</p>
<p>Anyways, all the time as usual, <a class="mention" href="/u/revant_one">@revant_one</a> is coming for rescue <img src="https://discuss.frappe.io/images/emoji/twitter/slight_smile.png?v=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"> . Most important thing is the direction you give. Commendable.</p>
<p>Kind Regards,<br>
Arun</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T12:50:54Z' class='post-time'>
                    March 2, 2023, 12:50pm
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T12:50:54Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="gsarunk" data-post="8" data-topic="101844">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="https://discuss.frappe.io/user_avatar/discuss.frappe.io/gsarunk/48/56791_2.png" class="avatar"> gsarunk:</div>
<blockquote>
<p>What is the impact on making these two params true?</p>
</blockquote>
</aside>
<p>These keys won‚Äôt be used in containers. <code>bench update</code> is not used in containers. We just do  <code>bench --site all migrate</code> after the new app code is replaced by updated image/containers.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T13:33:20Z' class='post-time'>
                    March 2, 2023,  1:33pm
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T13:33:20Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Then in that case we can remove these two fields as part of standard single sever setup, isn‚Äôt it?. Can we expect this as part of next update? or if you let me know where to make the change i can send a PR.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_11' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-02T17:46:18Z' class='post-time'>
                    March 2, 2023,  5:46pm
                  </time>
                  <meta itemprop='dateModified' content='2023-03-02T17:46:18Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>for kubernetes it mounts blank volume, it only creates whatever is executed during configuration.</p>
<p>I really don‚Äôt know why setting those values solved pdf rendering problem!</p>
<p>at this point just echo <code>{}</code> into common_site_config.json</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/frappe/frappe_docker/blob/28b18defa412fc39ab487ca62ada527da82b4e1d/images/production/Containerfile#L110-L111">
  <header class="source">

      <a href="https://github.com/frappe/frappe_docker/blob/28b18defa412fc39ab487ca62ada527da82b4e1d/images/production/Containerfile#L110-L111" target="_blank" rel="noopener">github.com</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/frappe/frappe_docker/blob/28b18defa412fc39ab487ca62ada527da82b4e1d/images/production/Containerfile#L110-L111" target="_blank" rel="noopener">frappe/frappe_docker/blob/28b18defa412fc39ab487ca62ada527da82b4e1d/images/production/Containerfile#L110-L111</a></h4>



    <pre class="onebox"><code class="lang-">
      <ol class="start lines" start="110" style="counter-reset: li-counter 109 ;">
          <li>echo "$(jq 'del(.db_host, .redis_cache, .redis_queue, .redis_socketio)' sites/common_site_config.json)" \</li>
          <li>  &gt; sites/common_site_config.json &amp;&amp; \</li>
      </ol>
    </code></pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>change Containerfile for production and custom and send PR</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="https://discuss.frappe.io/t/email-not-delivered-automatically/102344/6">Email not delivered automatically</a>
                        <meta itemprop='position' content='2'>
                      </div>
                </div>
          </div>
          <div id='post_12' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-03T05:40:55Z' class='post-time'>
                    March 3, 2023,  5:40am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-03T05:40:55Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Sure, I will do.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_13' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/revant_one'><span itemprop='name'>revant_one</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-05T11:36:53Z' class='post-time'>
                    March 5, 2023, 11:36am
                  </time>
                  <meta itemprop='dateModified' content='2023-03-05T11:36:53Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="onebox githubpullrequest" data-onebox-src="https://github.com/frappe/frappe_docker/pull/1088">
  <header class="source">

      <a href="https://github.com/frappe/frappe_docker/pull/1088" target="_blank" rel="noopener">github.com/frappe/frappe_docker</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">



    <div class="github-icon-container" title="Pull Request">
      <svg width="60" height="60" class="github-icon" viewbox="0 0 12 16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
    </div>

  <div class="github-info-container">



      <h4>
        <a href="https://github.com/frappe/frappe_docker/pull/1088" target="_blank" rel="noopener">fix: default config for production</a>
      </h4>

    <div class="branches">
      <code>frappe:main</code> ‚Üê <code>revant:fix-config</code>
    </div>

      <div class="github-info">
        <div class="date">
          opened <span class="discourse-local-date" data-format="ll" data-date="2023-03-05" data-time="11:36:36" data-timezone="UTC">11:36AM - 05 Mar 23 UTC</span>
        </div>

        <div class="user">
          <a href="https://github.com/revant" target="_blank" rel="noopener">
            <img alt="revant" src="https://avatars.githubusercontent.com/u/1040161?v=4" class="onebox-avatar-inline" width="20" height="20">
            revant
          </a>
        </div>

        <div class="lines" title="1 commits changed 2 files with 2 additions and 4 deletions">
          <a href="https://github.com/frappe/frappe_docker/pull/1088/files" target="_blank" rel="noopener">
            <span class="added">+2</span>
            <span class="removed">-4</span>
          </a>
        </div>
      </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">reported here https://discuss.frappe.io/t/frappe-docker-2023-production-setup-pa<span class="show-more-container"><a href="https://github.com/frappe/frappe_docker/pull/1088" target="_blank" rel="noopener" class="show-more">‚Ä¶</a></span><span class="excerpt hidden">ssword-reset-email-link-added-with-port-8000/101844</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_14' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/gsarunk'><span itemprop='name'>gsarunk</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-03-08T14:44:17Z' class='post-time'>
                    March 8, 2023,  2:44pm
                  </time>
                  <meta itemprop='dateModified' content='2023-03-08T14:44:17Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks <a class="mention" href="/u/revant_one">@revant_one</a> for fixing it. I missed your last line</p>
<blockquote>
<p>at this point just echo <code>{}</code> into common_site_config.json</p>
</blockquote>
<p>I was under impression to make the two field defaulted to true. Looking into your change, now i understood.</p>
<p>Anyways thanks for doing it yourself and sorry for not sending a PR <img src="https://discuss.frappe.io/images/emoji/twitter/frowning.png?v=12" title=":frowning:" class="emoji" alt=":frowning:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_15' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://discuss.frappe.io/u/cmubeenali'><span itemprop='name'>cmubeenali</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-09-13T08:12:57Z' class='post-time'>
                    September 13, 2025,  8:12am
                  </time>
                  <meta itemprop='dateModified' content='2025-09-13T08:12:57Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>thanks</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="erpnext-footer">
    <a href="https://frappe.io">Frappe</a>
</div>
    
  </body>
  
</html>
