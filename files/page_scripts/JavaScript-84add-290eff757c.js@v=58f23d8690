window.addEventListener("DOMContentLoaded",()=>{document.querySelector('.write-a-review-btn').addEventListener('click',function(e){document.querySelector('.review-form').style.display='flex';this.style.display='none';});document.querySelector('.review-form').addEventListener('submit',function(event){event.preventDefault();const formData=new FormData(this);formData.set("app",page_data?.app_name);const rating=document.getElementsByClassName("rating-star active-star").length
formData.set("rating",rating)
fetch('/api/method/press.api.marketplace.submit_user_review',{method:'POST',headers:{'Content-Type':'application/json',"X-Frappe-CSRF-Token":frappe.csrf_token},body:JSON.stringify(Object.fromEntries(formData)),}).then(response=>{if(!response.ok){throw new Error(`HTTP error! Status: ${response.status}`);}
return response.json();}).then(data=>{location.reload();}).catch(error=>{document.querySelector(".error-message").innerHTML="Something went wrong!";document.querySelector(".error-message").style.display="block";});});document.querySelector('.review-form').addEventListener('keydown',function(event){if((event.ctrlKey||event.metaKey)&&event.keyCode===13){document.querySelector('.submit-review-btn').click();}});});